<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>

  <head>
  <title>Royalflush</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
		 <link rel="stylesheet" href="css/theme.css">


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
 	<?php include('plugins/CommentsPlugin.php');
				include('plugins/UserStatusPlugin.php');
	
				$login = pageload();
				$regStat = '';
	
			if($login['login']){
				if($login['regStat']){
					$loginStat = '<script>$("#login a").hide(); 
					$("#reg a").hide();</script>';	
				} else {
					$loginStat = '<script>$("#logout a").hide();</script>';
					$regStat = '<div class="alert alert-warning fade in">
				<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
				<strong>Notice</strong> This account is registered but not activated. Please check email or click on this link, <a href="activation.php">Activate</a>
			</div>';
				}
			} else {
				$loginStat = '<script>$("#logout a").hide();
				$("#login a").show();
				$("#reg a").show();</script>';
			}
	
	$page = $_SERVER['PHP_SELF'];
	
	echo $regStat;
	
	if(isset($_GET['msg'])){
		$msg = htmlspecialchars($_GET['msg']);
		$type = htmlspecialchars($_GET['type']);
		
		echo  '<div class="alert alert-' . $type .  ' fade-out">
				<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
				<strong>Notice</strong> ' . $msg .'
			</div>';
		
	}
	
	?>
  
	
</head>

  <body>
		<?php 
		if($_SERVER['REQUEST_METHOD'] === 'POST'){
			$imgMainFormOp = '<img class="img-responsive col-xs-12 col-sm-10 col-md-10 col-lg-8 col-sm-offset-1 col-md-offset-1 col-lg-offset-2" atl="Main Artical Img" scr="';
			$imgMainFormCls = '">';
			$imgStdFormRtOp = '<img class="pull-right img-responsive col-md-8 col-lg-6" atl="Inline Article Img" scr="';
			$imgStdFormLtOp = '<img class="pull-left img-responsive col-md-8 col-lg-6" atl="Inline Article Img" scr="';
			$imgStdFormCls = '">';
			$parLdOp = '<p class="lead">';
			$parLdCls = '</p>';
			$parStdOp = '<p>';
			$parStdCls = '</p>';
			$lnkOP = '<a href="';
			$lnkMid = '">';
			$lnkCls = '</a>';
			
			$runOrd = array();
			$body = $mainPic = '';
			$i = 0;
			
			if(isset($_POST['runOrd'])){
				
				$runOrd = explode(",", $_POST['runOrd']);
				
				foreach ($runOrd as $str){
					
					switch (substr($str, -3)){
							
						case 'Txt':
							$body = textCont($str, $i);
							break;
						case 'Lnk':
							$body = linkCont($str, $i, $body);
							break;
						case 'Img':
							if(substr($str, 3, 1) == 1){
								$mainPic = ttlPic($str);
								break;
							} else {
								$body = picCont($str, $i);
								break;
							}
					}
					$i++;
				}
				
			$page = $mainPic . $body;
				
			}
		}
		
		function text($txt, $inx){
			if($inx >+ 1){
				if(substr($runOrd[$inx-1], -3) == 'Lnk' ){
					return $_POST[$txt] . $parStdCls;  //<-- this is for a text right after a link
				} else {
					if(substr($txt, 3, 1) == 1){
						return $parLdOp . $_POST[$txt] . $parLdCls; //<-- this is for first para thats not after a link
					} else {
						return $parStdOp . $_POST[$txt] . $parStdCls; //<-- this is for standard para thats not after a link
					}
				}
			} else {
				if(substr($txt, 3, 1) == 1){
					return $parLdOp . $_POST[$txt] . $parLdCls; //<-- if this is the first element
				} //else {
// 					return $parStdOp . $_POST[$txt] . $parStdCls;
// 				}
			}
		}
		
		function linkCont($txt, $inx, $bodyIn){
			
			if ($inx == 0){
				if (substr($runOrd[$inx+1], -3) == 'Txt' ){
					return '<p>' . $lnkOp . $_POST[$txt] . $lnkMid;//<-- used if the first element next is text
				} else {
					return $lnkOp . $_POST[$txt] . $lnkMid;//<-- used if the first element
				}
			} else {
				if(substr($txt, 4, 3) == 'Url'){
					if (substr($runOrd[$inx-1], -3) == 'Txt' ){
						return str_replace('</p>', $lnkOp . $_POST[$txt] . $lnkMid, $bodyIn);
					} else if (substr($runOrd[$inx+1], -3) == 'Txt'){
						return '<p>' . $lnkOp . $_POST[$txt] . $lnkMid;
					} else {
						return $lnkOp . $_POST[$txt] . $lnkMid;	
					}
				} else {
					if (substr($runOrd[$inx+1], -3) == 'Txt'){
						return $lnkCls;
					} else {
						if($inx >= 2){
							if(substr($runOrd[$inx-2], -3) == 'Txt'){
								return $lnkCls . '</p>';
							} 
						} else {
							return $lnkCls;
						}
					}
				}
			} 
		}
		
		function ttlPic($txt){
			return $imgMainFormOp . $txt . $imgMainFormCls;
		}
		
		function picCont($txt, $n){
			
			if ($n % 2 === 0){
				return $imgStdFormRtOp . $txt . $imgStdFormCls;
			} else {
				return $imgStdFormLtOp . $txt . $imgStdFormCls;
			}
			
		}

		?>
		
	  <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <!-- sets up the menu toggle when page is viewed on a small screen id mobile. -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navOptions">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                </button>
        <a class="navbar-brand" href=".">Royalflush</a>
        <!-- adds the home logo link to bar -->
      </div>
      <!-- adds the navigation links -->
      <div class="collapse navbar-collapse" id="navOptions">
        <ul class="nav navbar-nav">
          <li><a href="#">About</a></li>
          <li><a href="#">Contact Us</a></li>
          <li class="dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="dropDev"> 
                      Dev Pages
                      <span class="caret"></span>
                    </a>
            <ul class="dropdown-menu" id="devList">
              <li><a href="scratPad.php?page=<?php echo $page ?>">Scratch Pad</a></li>
              <li><a href="indexBootstrapDemo.html">Bootstap</a></li>
              <li><a href="LoginPage.php">Login</a></li>
              <li><a href="Register.php">Registration</a></li>
              <li><a href="examplePage.html">Example</a></li>
              <li><a href="twitterFeed.php">Twitter</a></li>
               <li><a href="canvasDemo.html">canvas</a></li>
              <li><a href="CommentsPlugin.php">comment</a></li>
            </ul>
          </li>
        </ul>
				<ul class="nav navbar-nav navbar-right">
					<li id="reg"><a href="Register.php"
								 data-toggle="tooltip" 
								 data-placement="bottom" 
								 title="Register"><span class="glyphicon glyphicon-user"></span></a></li>
					<li id="login"><a href="LoginPage.php?page=<?php echo $page; ?>" 
								 data-toggle="tooltip" 
								 data-placement="bottom" 
								 title="Log In">
							<span class="glyphicon glyphicon-log-in"></span></a></li>
					<li id="logout"><a href="plugins/logout.php?page=<?php echo $page; ?>" 
								 data-toggle="tooltip" 
								 data-placement="bottom" 
								 title="Log Out">
							<span class="glyphicon glyphicon-log-out"></span></a></li>
					
				</ul>
      </div>

    </div>
  </nav>
  	<div class="container" id="formDiv">
			
		 <div class="form-group">
						<label class="control-label col-md-2" for="edit" >Insert Options</label>
						<div class="btn-group col-md-6" role="group">
							<button class="btn btn-success" id="btnTxtBx" role="button">Article Text</button>
							<button class="btn btn-success" id="btnPic" role="button">Picture</button>
							<button class="btn btn-success" id="btnLnkBx" role="button">link</button>
							<!-- <button class="btn btn-success" id="btnTag" role="button">tag</button> -->
						</div>
					</div>
			<br/>
			<br/>
			
			<div class="row">
				
<!-- 				<form class="form-horizontal" id="artForm"  methode="post" action="<?php //echo $_SERVER['PHP_SELF']; ?>" encrtype="multipart/form-data"> -->
				<form class="form-horizontal" id="artForm">
					
					
					
					<div class="panel col-md-8 col-md-offset-1" id="artPnl">
						
						<div class="form-group">
						<label class="control-label col-md-2" for="headline">Headline</label>
						<div class="col-md-10">
							<input type="text" class="form-control" id="headline" placeholder="Add headline here">
						</div>
					</div>
						
					</div>
<!-- 					<div class="form-group">
						<label class="control-label col-md-2" for="headline">Headline</label>
						<div class="col-md-6">
							<input type="text" class="form-control" id="headline" placeholder="Add headline here">
						</div>
					</div> -->
					
					
<!-- 					<div class="form-group">
						<label class="control-label col-md-2" for="headline">Article text 1</label>
						<div class="col-md-6">
							<textarea type="text" class="form-control" id="Atr1Txt" placeholder="Article Content here"></textarea>
						</div>
					</div> -->
					
					
				</form>
				
			<div class="col-md-4 col-md-offset-2">
				<button role="button" class="btn btn-success" id="preBtn">
					Preview
				</button>
				</div>	
				</div>
			
				<div class="row">
				<p id="runOrd">
					
					</p>
					<div class="panel panel-default" id="preVwPnl">
						<div class="row" id="preTtl">
							
						</div>
						<div class="row">
							<div id="preMain">
								
							</div>
						</div>
					</div>
				</div>
				
			
			
		
		</div>
  </body>
	<script src="js/site.js"></script>
</html>